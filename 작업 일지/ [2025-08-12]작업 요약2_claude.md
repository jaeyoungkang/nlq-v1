# 화이트리스트 로그인 실패 시 헤더 알림 표시 구현

## 개요
백엔드에 구현된 화이트리스트 계정 로그인 기능과 연동하여, 프론트엔드에서 화이트리스트 로그인 실패 시 헤더에 알림을 표시하는 기능을 구현했습니다.

## 구현 내용

### 1. 인증 스토어 확장 (`frontend/src/stores/useAuthStore.ts`)

#### 추가된 인터페이스
```typescript
export interface WhitelistError {
  message: string;
  errorType: string;
  reason?: string;
  userStatus?: string;
}
```

#### 스토어 상태 확장
- `whitelistError: WhitelistError | null` 상태 추가
- `setWhitelistError: (error: WhitelistError | null) => void` 액션 추가
- 로그아웃 시 화이트리스트 에러 상태 초기화

### 2. 인증 훅 수정 (`frontend/src/hooks/useAuth.ts`)

#### Google 로그인 에러 처리 개선
```typescript
if (error.response?.status === 403 && errorData?.error_type === 'access_denied') {
  // 화이트리스트 관련 에러 처리
  setWhitelistError({
    message: errorData.error || '접근이 거부되었습니다',
    errorType: errorData.error_type,
    reason: errorData.details?.reason,
    userStatus: errorData.details?.user_status
  });
}
```

#### 처리되는 에러 타입
- `not_whitelisted`: 화이트리스트에 등록되지 않은 계정
- `pending_approval`: 승인 대기 중인 계정
- `account_disabled`: 비활성화된 계정

### 3. 헤더 컴포넌트 업데이트 (`frontend/src/components/Header.tsx`)

#### 알림 배너 UI
- 빨간색 배경 (`bg-red-50`, `border-red-200`)의 알림 배너
- 경고 아이콘과 함께 "접근 권한 없음" 제목 표시
- 백엔드에서 전달받은 에러 메시지 표시

#### 에러 이유별 맞춤 안내 메시지
- `pending_approval`: "관리자 승인 후 서비스를 이용하실 수 있습니다."
- `not_whitelisted`: "https://analytics.artificialmind.kr/ 에서 계정 등록을 요청하세요!"

#### 사용자 인터랙션
- X 버튼을 통한 수동 알림 닫기 기능
- 호버 효과 (`hover:text-red-600`)

## 백엔드 연동 정보

### API 응답 구조 (403 에러 시)
```json
{
  "success": false,
  "error": "접근이 허용되지 않은 계정입니다. 관리자에게 계정 등록을 요청하세요.",
  "error_type": "access_denied",
  "details": {
    "reason": "not_whitelisted",
    "user_status": "unregistered",
    "support_message": "문의사항이 있으시면 관리자에게 연락하세요.",
    "timestamp": "2025-01-XX..."
  }
}
```

### 처리되는 접근 거부 사유
1. **not_whitelisted**: 화이트리스트에 등록되지 않은 계정
2. **pending_approval**: 계정 승인이 대기 중
3. **account_disabled**: 계정이 비활성화됨

## 사용자 경험 개선점

1. **명확한 피드백**: 로그인 실패 이유를 구체적으로 안내
2. **액션 가이드**: 계정 등록 링크 제공으로 다음 단계 안내
3. **비침습적 UI**: 헤더 상단의 배너로 정보 전달, 사용자가 직접 닫을 수 있음
4. **시각적 구분**: 빨간색 테마로 중요도 강조

## 기술적 특징

- **타입 안전성**: TypeScript 인터페이스로 에러 상태 구조화
- **상태 관리**: Zustand 스토어를 통한 중앙화된 에러 상태 관리
- **컴포넌트 분리**: 각 컴포넌트의 책임 명확히 구분
- **에러 처리**: HTTP 상태 코드와 에러 타입을 기반으로 한 세밀한 처리

## 구현 완료 사항

✅ 백엔드 화이트리스트 인증 API 분석  
✅ 헤더 컴포넌트 구조 분석  
✅ 인증 스토어에 화이트리스트 에러 상태 추가  
✅ 헤더에 알림 표시 컴포넌트 구현  

이제 화이트리스트에 등록되지 않은 사용자가 로그인을 시도하면, 헤더에서 명확한 안내 메시지와 함께 계정 등록 링크를 확인할 수 있습니다.