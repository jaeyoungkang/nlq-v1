### **작업 요약: LLM 프롬프트 아키텍처 단순화 및 레거시 코드 정리**

#### 🎯 **작업 목표**
- `llm_client.py`와 연관된 프롬프트 파일들(`classification.json`, `sql_generation.json`, `data_analysis.json`)의 구조를 단순화하여 코드 가독성과 유지보수성을 향상시킵니다.
- 컨텍스트 유무에 따라 분기되던 로직을 통합하고, 더 이상 사용되지 않는 레거시 프롬프트 템플릿을 제거하여 LLM이 문맥을 통해 후속 질문이나 분석 요청을 직접 판단하도록 아키텍처를 개선합니다.

---

### **주요 변경 사항**

#### **1. 프롬프트 템플릿 파일 정리 및 역할 재정의**

-   **템플릿 최소화**: 각 `.json` 파일에서 `system_prompt`와 `user_prompt` 두 개의 핵심 템플릿만 남기고, 불필요한 보조 및 레거시 템플릿(`*_with_context`)을 모두 제거했습니다.컨텍스트_통합_프롬프팅_구현_완료.md]
-   **역할 명확화**:
    -   `system_prompt`: AI의 역할, 기본 규칙, 데이터 스키마 등 **정적인 정보**를 통합하여 제공합니다.
    -   `user_prompt`: 이전 대화 기록(`$conversation_context`), 현재 질문 등 매번 변경되는 **동적인 정보**만 전달하도록 단순화했습니다.
-   **분류 체계 단순화 (`classification.json`)**: `follow_up_query`와 같은 세분화된 컨텍스트 카테고리를 `query_request`로 통합하여 분류 체계를 단순화했습니다. 단, **`data_analysis`는 그 역할의 고유성을 고려하여 별도 카테고리로 유지**했습니다.
-   **SQL 생성 규칙 강화 (`sql_generation.json`)**:
    -   **SQL 전용 출력 강제**: AI가 자연어 설명 대신 **반드시 SQL 코드만 반환**하도록 강력한 출력 규칙을 추가하여 구문 오류를 해결했습니다.
    -   **정확한 테이블명 사용**: 프롬프트에 명시된 전체 테이블 이름(`$default_table`)을 사용하도록 규칙을 추가하여 "테이블을 찾을 수 없음" 오류를 방지했습니다.

#### **2. `llm_client.py` 코드 리팩토링**

-   **레거시 메서드 제거**: 호환성을 위해 남겨두었던 `_execute_with_context`와 같은 레거시 메서드를 완전히 삭제했습니다.
-   **호출 구조 단순화**: `classify_input`, `generate_sql`, `analyze_data` 메서드가 이제 단일화된 `_execute_unified_prompting` 메서드를 직접 호출하도록 구조를 간결하게 변경했습니다.
-   **헬퍼 함수 제거**: 프롬프트 파일이 단순화됨에 따라, 프롬프트 문자열을 동적으로 조립하던 `_create_dataset_info`와 같은 보조 함수들을 제거했습니다.

---

### ✅ **기대 효과**

-   **가독성 향상**: 프롬프트의 역할과 코드의 흐름이 명확해져 코드를 이해하기 쉬워졌습니다.
-   **유지보수 용이성**: 프롬프트 수정 시 `.json` 파일만 변경하면 되므로 유지보수 비용이 감소합니다.
-   **안정성 및 일관성**: 모든 LLM 호출이 단일화된 경로(`_execute_unified_prompting`)를 통해 처리되므로, 동작의 일관성과 안정성이 향상되었습니다.
-   **LLM 성능 극대화**: 시스템의 복잡한 분기 로직을 줄이고, LLM이 가장 잘하는 문맥 이해 능력에 더 의존하여 전반적인 AI 성능을 향상시켰습니다.